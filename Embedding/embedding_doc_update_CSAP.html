<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>ê³µê³µ ì„œë²„ìš© í…œí”Œë¦¿ ë¬¸ì„œ ì‘ì„± ë° ë¯¸ë¦¬ë³´ê¸°</title>

  <!-- ê³µê³µ ì„œë²„ìš© ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ -->
  <script src="https://www.gov-eformsign.com/plugins/jquery/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jsrsasign/8.0.20/jsrsasign-all-min.js"></script>
  <script src="https://www.gov-eformsign.com/lib/js/efs_embedded_v2.js"></script>

  <style>
    /* ê¸°ë³¸ ë ˆì´ì•„ì›ƒ */
    body {
      font-family: Arial, sans-serif;
      background-color: #eef2f7;
      color: #333;
      margin: 0;
      padding: 20px;
      display: flex;
      height: 100vh;
      box-sizing: border-box;
    }
    .left-panel, .right-panel {
      padding: 20px;
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      box-sizing: border-box;
    }
    .left-panel { width: 45%; overflow-y: auto; margin-right: 5%; }
    .right-panel { width: 50%; display: flex; flex-direction: column; position: relative; }
    h2 { text-align: center; color: #333; margin-bottom: 20px; font-size: 1.5em; }
    .form-group { margin-bottom: 15px; display: flex; flex-direction: column; }
    .form-group label { font-weight: bold; margin-bottom: 5px; color: #555; }
    .form-group input, .form-group select, .form-group textarea {
      width: 100%; padding: 10px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;
      transition: border-color 0.3s; box-sizing: border-box;
    }
    .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
      outline: none; border-color: #007bff;
    }
    .btn {
      width: 100%; padding: 12px; font-size: 16px; font-weight: bold; color: #fff; background: #007bff;
      border: none; border-radius: 4px; cursor: pointer; transition: background 0.3s; margin-top: 10px;
    }
    .btn:hover { background: #0056b3; }

    /* ì•¡ì…˜ ë²„íŠ¼ ë¦¬ìŠ¤íŠ¸ */
    #buttonList { display: none; flex-wrap: wrap; gap: 10px; justify-content: center; }
    #buttonList button {
      width: 100px; height: 35px; border-radius: 4px; background: #6c757d; color: #fff; border: none;
      cursor: pointer; font-size: 14px; display: none; transition: background 0.3s;
    }
    #buttonList button:hover { background: #5a6268; }

    /* iframe */
    .iframe-title { text-align: center; font-weight: bold; color: #444; margin-bottom: 10px; }
    .iframe-container {
      flex: 1; border: 2px solid #ddd; border-radius: 8px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    iframe { width: 100%; height: 100%; border: none; }

    /* ë¡œë”© ì¸ë””ì¼€ì´í„° */
    #loadingIndicator {
      display: none; position: absolute; top: 50%; left: 50%;
      transform: translate(-50%, -50%); padding: 1em 2em; background: rgba(0,0,0,0.7);
      color: #fff; border-radius: 8px; font-size: 1.2em; z-index: 1000;
    }

    /* ì¶”ê°€ ì˜µì…˜ íŒ¨ë„ */
    #additionalOptions { display: none; margin-top: 10px; padding: 15px; background: #f8f9fa; border: 1px solid #ddd; border-radius: 6px; }
    .option-section { margin-bottom: 20px; padding: 10px; border: 1px solid #ccc; border-radius: 6px; background: #fff; }
    .option-section h3 { margin-top: 0; margin-bottom: 10px; font-size: 1.1em; color: #007bff; }
    .entry-list { margin-top: 10px; }
    .entry-item { position: relative; padding: 10px; border: 1px solid #ccc; border-radius: 4px; background: #fafafa; margin-bottom: 10px; }
    .entry-item .remove-entry { position: absolute; top: 5px; right: 5px; background: #dc3545; color: #fff; border: none; border-radius: 50%; width: 20px; height: 20px; font-size: 12px; line-height: 20px; cursor: pointer; }

    /* í† ê¸€ ìŠ¤ìœ„ì¹˜ */
    .switch { position: relative; display: inline-block; width: 50px; height: 24px; vertical-align: middle; }
    .switch input { opacity: 0; width: 0; height: 0; }
    .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: 0.4s; border-radius: 24px; }
    .slider:before { position: absolute; content: ""; height: 18px; width: 18px; left: 3px; bottom: 3px; background-color: white; transition: 0.4s; border-radius: 50%; }
    .switch input:checked + .slider { background-color: #007bff; }
    .switch input:checked + .slider:before { transform: translateX(26px); }

    /* ë°˜ì‘í˜• */
    @media (max-width: 768px) { .left-panel, .right-panel { width: 100%; margin: 0; } }
    @media (max-width: 600px) { .btn, #buttonList button { font-size: 14px; padding: 10px; } }
  </style>

  <script>
    let execution_time = '';
    let docOpt;

    $(function(){
      // ê³µê³µ ì„œë²„ìš© EformSignDocument ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ë° ë„ë©”ì¸ ì§€ì •
      window.eformsign = new EformSignDocument();
      eformsign.setDomain("https://www.gov-eformsign.com");

      // UI ë°”ì¸ë”©
      $('#modeTypeSelect').on('change', function(){
        const v = this.value;
        $('#docIdGroup')[ (v==='02' || v==='03') ? 'show' : 'hide' ]();
      }).trigger('change');

      $('#userTypeSelect').on('change', function(){
        const ut = this.value;
        if(ut === '01'){ // ë©¤ë²„
          $('#authSection').show();
          $('#externalInfoSection').hide();
          $('#companyId').prop('readonly', true);
        } else { // ì™¸ë¶€
          $('#authSection').hide();
          $('#externalInfoSection').show();
          $('#companyId').prop('readonly', false).val('');
        }
      }).trigger('change');

      $('#toggleOptionsBtn').click(()=>$('#additionalOptions').slideToggle());

      $('#toggleActionSwitch').on('change', function(){
        $('#buttonList').css('display', this.checked ? 'flex' : 'none');
        $('#toggleActionLabel').text(this.checked ? 'Action ë²„íŠ¼ ìˆ¨ê¸°ê¸°' : 'Action ë²„íŠ¼ ë³´ì´ê¸°');
      }).prop('checked', false).trigger('change');

      // í† í° ë°©ì‹ ë¼ë²¨ ë™ê¸°í™”
      $('#tokenMethodSelect').on('change', updateTokenLabel);
      updateTokenLabel(); // ì´ˆê¸° 1íšŒ ë°˜ì˜

      $('#addFieldBtn').click(addFieldEntry);
      $('#addRecipientBtn').click(addRecipientEntry);
      $('#getTokenButton').click(getAccessToken);
      $('#startButton').click(startDocument);
    });

    function showLoading(){ $('#loadingIndicator').show(); }
    function hideLoading(){ $('#loadingIndicator').hide(); }
    function resetActionButtons(){ $('#buttonList button').hide().text(''); }

    /** í† í° ë°©ì‹ ì „í™˜ ì‹œ ë¼ë²¨/placeholder ë™ê¸°í™” */
    function updateTokenLabel(){
      if ($('#tokenMethodSelect').val() === 'signature') {
        $('#secretKeyLabel').text('Private Key Hex:');
        $('#privateKeyHex').attr('placeholder','ë¹„ë°€í‚¤ ì…ë ¥');
      } else {
        $('#secretKeyLabel').text('Bearer Token:');
        $('#privateKeyHex').attr('placeholder','Bearer í† í° ì…ë ¥');
      }
    }

    /** ì„ë² ë”© ì¢…ë£Œ ìœ í‹¸: close() ê°€ëŠ¥ ì‹œ í˜¸ì¶œ, iframe ë¹„ìš°ê³  ìˆ¨ê¹€, UI ì´ˆê¸°í™”, ì¸ìŠ¤í„´ìŠ¤ í•´ì œ */
    function endEmbedding({ resetUI = true, hideFrame = true } = {}) {
      try {
        if (window.eformsign && typeof window.eformsign.close === 'function') {
          window.eformsign.close();
        }
      } catch (e) {
        console.log('eformsign.close() í˜¸ì¶œ ì¤‘ ì˜ˆì™¸:', e);
      }

      const $frame = $('#eformsign_iframe');
      $frame.attr('src','about:blank');
      if (hideFrame) {
        $frame.closest('.iframe-container').css('display','none');
      }

      if (resetUI) {
        resetActionButtons();
        $('#toggleActionSwitch').prop('checked', false).trigger('change');
      }

      window.eformsign = null; // GC ìœ ë„ ë° ì¬ì‹œì‘ ì‹œ ìƒˆ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
    }

    function getAccessToken(){
      execution_time = Date.now() + '';
      const method = $('#tokenMethodSelect').val();
      const apiKey = $('#apiKey').val();
      const memberId = $('#userId').val();
      const requestURL = 'https://www.gov-eformsign.com/Service/v2.0/api_auth/access_token';
      const body = { execution_time, member_id: memberId };

      let signatureValue;
      if(method === 'signature'){
        const pk = KEYUTIL.getKeyFromPlainPrivatePKCS8Hex($('#privateKeyHex').val());
        const sig = new KJUR.crypto.Signature({ alg: 'SHA256withECDSA' });
        sig.init(pk);
        sig.updateString(execution_time);
        signatureValue = sig.sign();
      } else {
        signatureValue = 'Bearer ' + $('#privateKeyHex').val();
      }

      $.ajax({
        url: requestURL,
        type: 'POST',
        contentType: 'application/json; charset=UTF-8',
        data: JSON.stringify(body),
        beforeSend: function(req){
          req.setRequestHeader('eformsign_signature', signatureValue);
          req.setRequestHeader('Authorization', 'Bearer ' + btoa(apiKey));
        },
        success: function(data){
          $('#accessToken').val(data.oauth_token.access_token);
          $('#refreshToken').val(data.oauth_token.refresh_token);
          $('#companyId').val(data.api_key.company.company_id);
          console.log('Access Token ë°œê¸‰ ì‘ë‹µ:', data);
        },
        error: function(xhr){
          try {
            const r = JSON.parse(xhr.responseText);
            console.log('Access Token ë°œê¸‰ ì˜¤ë¥˜ ì‘ë‹µ:', r);
            alert(`ë°œê¸‰ ì‹¤íŒ¨:\nì½”ë“œ: ${r.code}\në©”ì‹œì§€: ${r.ErrorMessage}`);
          } catch(e) {
            alert('ë°œê¸‰ ì‹¤íŒ¨(ì‘ë‹µ íŒŒì‹± ì˜¤ë¥˜). ì½˜ì†” ë¡œê·¸ë¥¼ í™•ì¸í•˜ì„¸ìš”.');
          }
        }
      });
    }

    // í•„ë“œ í•­ëª© ì¶”ê°€
    function addFieldEntry(){
      const entry = $(`
        <div class="entry-item field-entry">
          <button type="button" class="remove-entry" title="ì‚­ì œ">&times;</button>
          <div class="form-group">
            <label>í•„ë“œëª… (id):</label>
            <input type="text" class="field-id" placeholder="ì˜ˆ: ê³ ê°ëª…" />
          </div>
          <div class="form-group">
            <label>ê°’ (value):</label>
            <input type="text" class="field-value" placeholder="ì˜ˆ: í™ê¸¸ë™" />
          </div>
          <div class="form-group">
            <label>í™œì„±í™” ì—¬ë¶€ (enabled):</label>
            <label class="switch">
              <input type="checkbox" class="field-enabled" checked />
              <span class="slider"></span>
            </label>
          </div>
          <div class="form-group">
            <label>í•„ìˆ˜ ì—¬ë¶€ (required):</label>
            <label class="switch">
              <input type="checkbox" class="field-required" checked />
              <span class="slider"></span>
            </label>
          </div>
        </div>
      `);
      entry.find('.remove-entry').click(() => entry.remove());
      $('#fieldsList').append(entry);
    }

    // ìˆ˜ì‹ ì í•­ëª© ì¶”ê°€
    function addRecipientEntry(){
      const entry = $(`
        <div class="entry-item recipient-entry">
          <button type="button" class="remove-entry" title="ì‚­ì œ">&times;</button>
          <div class="form-group">
            <label>ì›Œí¬í”Œë¡œìš° ìˆœì„œ (step_idx):</label>
            <input type="text" class="rec-step-idx" placeholder="ì˜ˆ: 2" />
          </div>
          <div class="form-group">
            <label>ë‹¨ê³„ ì¢…ë¥˜ (step_type):</label>
            <select class="rec-step-type">
              <option value="05">ì°¸ì—¬ì (05)</option>
              <option value="06">ê²€í† ì (06)</option>
            </select>
          </div>
          <div class="form-group">
            <label>ì´ë¦„ (name):</label>
            <input type="text" class="rec-name" placeholder="ì˜ˆ: ê¹€í…ŒìŠ¤íŠ¸" />
          </div>
          <div class="form-group">
            <label>ID/ì´ë©”ì¼ (id):</label>
            <input type="text" class="rec-id" placeholder="ì˜ˆ: test@forcs.com" />
          </div>
          <div class="form-group">
            <label>í•¸ë“œí° ë²ˆí˜¸ (sms):</label>
            <input type="text" class="rec-sms" placeholder="ì˜ˆ: 01023456789" />
          </div>
          <div class="form-group">
            <label>ì´ë©”ì¼ ì•Œë¦¼ ì‚¬ìš© (use_mail):</label>
            <label class="switch">
              <input type="checkbox" class="rec-use-mail" checked />
              <span class="slider"></span>
            </label>
          </div>
          <div class="form-group">
            <label>SMS ì•Œë¦¼ ì‚¬ìš© (use_sms):</label>
            <label class="switch">
              <input type="checkbox" class="rec-use-sms" checked />
              <span class="slider"></span>
            </label>
          </div>
          <div class="form-group">
            <label>ë¹„ë°€ë²ˆí˜¸ (auth.password):</label>
            <input type="text" class="rec-auth-password" placeholder="ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ (ì„ íƒ)" />
          </div>
          <div class="form-group">
            <label>ë¹„ë°€ë²ˆí˜¸ íŒíŠ¸ (auth.password_hint):</label>
            <input type="text" class="rec-auth-hint" placeholder="ë¹„ë°€ë²ˆí˜¸ íŒíŠ¸ ì…ë ¥ (ì„ íƒ)" />
          </div>
          <div class="form-group">
            <label>ì „ì†¡ ê¸°í•œ - ì¼ (valid.day):</label>
            <input type="number" class="rec-valid-day" value="7" min="0" />
          </div>
          <div class="form-group">
            <label>ì „ì†¡ ê¸°í•œ - ì‹œ (valid.hour):</label>
            <input type="number" class="rec-valid-hour" value="0" min="0" />
          </div>
          <div class="form-group">
            <label>ë¬¸ì„œ ë§í¬ (document_link):</label>
            <input type="text" class="rec-document-link" placeholder="ì•Œë¦¼ ë©”ì¼/SMSì˜ document_linkë¡œ ì‚¬ìš©í•  URL" />
          </div>
        </div>
      `);
      entry.find('.remove-entry').click(() => entry.remove());
      $('#recipientsList').append(entry);
    }

    function validateInputs(){
      const cid = ($('#companyId').val()||'').trim();
      if (!cid){ alert('íšŒì‚¬ IDë¥¼ ì…ë ¥í•˜ì„¸ìš”.'); return false; }
      return true;
    }

    function buildDocOpt(){
      const userType = $('#userTypeSelect').val();
      const modeType = $('#modeTypeSelect').val();
      const companyIdVal = $('#companyId').val().trim();

      let userObj;
      if(userType === '01'){
        userObj = {
          type: '01',
          id: $('#userId').val(),
          refresh_token: $('#refreshToken').val(),
          access_token: $('#accessToken').val()
        };
      } else {
        const externalName = ($('#externalName').val() || '').trim();
        const externalToken = ($('#externalToken').val() || '').trim();
        userObj = (modeType === '01')
          ? { type: '02', external_user_info: { name: externalName } }
          : { type: '02', external_token: externalToken, external_user_info: { name: externalName } };
      }

      const layoutOpts = {
        lang_code: $('#layoutLang').val(),
        header: $('#layoutHeader').is(':checked'),
        footer: $('#layoutFooter').is(':checked'),
        context_menu: $('#layoutContextMenu').is(':checked'),
        zoom: $('#layoutZoom').val(),
        viewer_toolbar: {
          'toolbar.save': $('#layoutSave').is(':checked'),
          'toolbar.print': $('#layoutPrint').is(':checked')
        }
      };

      const prefill = {
        document_name: $('#prefillDocumentName').val(),
        fields: [],
        recipients: [],
        comment: $('#prefillComment').val(),
        is_hidden_stamp: $('#prefillHiddenStamp').is(':checked')
      };

      $('.field-entry').each(function(){
        const id = $(this).find('.field-id').val();
        const value = $(this).find('.field-value').val();
        const enabled = $(this).find('.field-enabled').is(':checked');
        const required = $(this).find('.field-required').is(':checked');
        if ((id||'').trim()) prefill.fields.push({ id, value, enabled, required });
      });

      $('.recipient-entry').each(function(){
        const step_idx = $(this).find('.rec-step-idx').val();
        const step_type = $(this).find('.rec-step-type').val();
        const name = $(this).find('.rec-name').val();
        const id = $(this).find('.rec-id').val();
        const sms = $(this).find('.rec-sms').val();
        const use_mail = $(this).find('.rec-use-mail').is(':checked');
        const use_sms = $(this).find('.rec-use-sms').is(':checked');
        const password = $(this).find('.rec-auth-password').val();
        const password_hint = $(this).find('.rec-auth-hint').val();
        const day = parseInt($(this).find('.rec-valid-day').val(), 10) || 0;
        const hour = parseInt($(this).find('.rec-valid-hour').val(), 10) || 0;
        const document_link = $(this).find('.rec-document-link').val() || '';
        if ((id||'').trim()) {
          prefill.recipients.push({
            step_idx, step_type, name, id, sms, use_mail, use_sms,
            auth: { password, password_hint, valid: { day, hour } },
            document_link
          });
        }
      });

      docOpt = {
        company: { id: companyIdVal, country_code: $('#countryCode').val() || 'kr', user_key: '' },
        user: userObj,
        mode: {
          type: modeType,
          template_id: $('#templateId').val(),
          document_id: $('#documentId').val() || ''
        },
        layout: layoutOpts,
        prefill
      };
    }

    function success_callback(response){
      hideLoading();
      alert(`ë¬¸ì„œ ìƒì„±/ì²˜ë¦¬ ì„±ê³µ\në¬¸ì„œ ID: ${response.document_id}\në¬¸ì„œ ì œëª©: ${response.title}`);
      console.log("âœ… ë¬¸ì„œ ìƒì„±/ì „ì†¡ ì„±ê³µ (Success Callback ì‘ë‹µ):");
      console.log(JSON.stringify(response, null, 4));

      // ì„ë² ë”© ì¢…ë£Œ
      endEmbedding({ resetUI: true, hideFrame: true });
      $('.iframe-title').text('ë¬¸ì„œ ì˜ì—­ (ì™„ë£Œë¨)');
    }

    function error_callback(err){
      hideLoading();
      alert(`ë¬¸ì„œ ìƒì„±/ì²˜ë¦¬ ì‹¤íŒ¨\nì½”ë“œ: ${err.code}\në©”ì‹œì§€: ${err.message}`);
      console.log("âŒ ë¬¸ì„œ ìƒì„±/ì „ì†¡ ì‹¤íŒ¨ (Error Callback ì‘ë‹µ):");
      console.log(JSON.stringify(err, null, 4));
      // ì‹¤íŒ¨ ì‹œì—ëŠ” í”„ë ˆì„ ìœ ì§€(ë””ë²„ê¹…/ì¬ì‹œë„ ëª©ì )
    }

    function actions_callback(actions){
      hideLoading();
      resetActionButtons();
      const arr = Array.isArray(actions.data) ? actions.data : [actions.data];
      arr.forEach(function(a){
        $(`#btn_${a.code}`).text(a.name).show();
      });
      console.log('ğŸ”˜ Action Callback ì‘ë‹µ:', JSON.stringify(actions, null, 4));
    }

    function startDocument(){
      resetActionButtons();
      if (!validateInputs()) return;
      buildDocOpt();
      console.log('Request JSON:', JSON.stringify(docOpt, null, 2));

      // ì œëª© ì›ë³µ + ìˆ¨ê²¨ë†¨ì„ ìˆ˜ ìˆëŠ” í”„ë ˆì„ ë‹¤ì‹œ í‘œì‹œ
      $('.iframe-title').text('ë¬¸ì„œ ì˜ì—­');
      $('.iframe-container').css('display','block');

      // í•„ìš” ì‹œ ìƒˆ ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ë° ë„ë©”ì¸ ì¬ì„¤ì •
      if (!window.eformsign) {
        window.eformsign = new EformSignDocument();
        eformsign.setDomain("https://www.gov-eformsign.com");
      }

      showLoading();
      eformsign.document(
        docOpt,
        'eformsign_iframe',
        success_callback,
        error_callback,
        actions_callback
      );
      eformsign.open();
    }

    // actionTest ì „ì—­ í•¨ìˆ˜
    function actionTest(code){
      if (!window.eformsign) {
        alert('ì„ë² ë”©ì´ í™œì„±í™”ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤. Startë¡œ ë‹¤ì‹œ ì‹œì‘í•˜ì„¸ìš”.');
        return;
      }
      console.log('ì‚¬ìš©ì í´ë¦­í•œ action ì½”ë“œ:', code);
      eformsign.sendAction(
        { type: '01', code: code },
        function(response){
          console.log('Action ì‘ë‹µ (Response):', response);
        },
        function(err){
          console.log('Action ìš”ì²­ ì˜¤ë¥˜:', err);
        }
      );
    }
  </script>
</head>

<body>
  <div class="left-panel">
    <h2>ê³µê³µ ì„œë²„ìš© í…œí”Œë¦¿ ë¬¸ì„œ ì‘ì„±, ìˆ˜ì •, ë¯¸ë¦¬ë³´ê¸°</h2>

    <!-- ì‚¬ìš©ì ìœ í˜• -->
    <div class="form-group">
      <label>ì‚¬ìš©ì ìœ í˜•:</label>
      <select id="userTypeSelect">
        <option value="01" selected>ë©¤ë²„</option>
        <option value="02">ì™¸ë¶€ ì‚¬ìš©ì</option>
      </select>
    </div>
    <div id="externalInfoSection" style="display:none;">
      <div class="form-group">
        <label>ì™¸ë¶€ ì‚¬ìš©ì ì´ë¦„:</label>
        <input id="externalName" placeholder="ì˜ˆ: í™ê¸¸ë™" />
      </div>
      <div class="form-group">
        <label>ì™¸ë¶€ í† í° (mode 02,03ì¼ ë•Œ):</label>
        <input id="externalToken" placeholder="ì™¸ë¶€ í† í° ì…ë ¥" />
      </div>
    </div>

    <!-- íšŒì‚¬ ID -->
    <div class="form-group">
      <label>íšŒì‚¬ ID:</label>
      <input id="companyId" placeholder="Access_token ë°œê¸‰ ì‹œ ìë™ìœ¼ë¡œ ì±„ì›Œì§" readonly />
    </div>

    <!-- ì¸ì¦ -->
    <div id="authSection">
      <div class="form-group">
        <label>í† í° ë°œê¸‰ ë°©ì‹:</label>
        <select id="tokenMethodSelect">
          <option value="signature" selected>Signature ë°©ì‹</option>
          <option value="bearer">Bearer ë°©ì‹</option>
        </select>
      </div>
      <div class="form-group">
        <label id="secretKeyLabel">Private Key Hex:</label>
        <input id="privateKeyHex" placeholder="ë¹„ë°€í‚¤ ì…ë ¥" />
      </div>
      <div class="form-group">
        <label>API Key:</label>
        <input id="apiKey" placeholder="API Key ì…ë ¥" />
      </div>
      <div class="form-group">
        <label>ë©¤ë²„ ID (ë¡œê·¸ì¸ìš©):</label>
        <input id="userId" placeholder="ì´ë©”ì¼ ë“± ì‹ë³„ì ì…ë ¥" />
      </div>
      <button id="getTokenButton" class="btn">Get Access Token</button>
      <div class="form-group"><label>Access Token:</label><input id="accessToken" readonly /></div>
      <div class="form-group"><label>Refresh Token:</label><input id="refreshToken" readonly /></div>
    </div>

    <!-- ë¬¸ì„œ ì˜µì…˜ -->
    <div class="form-group">
      <label>Country Code:</label>
      <input id="countryCode" placeholder="ê¸°ë³¸ kr" />
    </div>
    <div class="form-group">
      <label>Mode Type:</label>
      <select id="modeTypeSelect">
        <option value="01" selected>ë¬¸ì„œ ì‘ì„± (01)</option>
        <option value="02">ë¬¸ì„œ ì²˜ë¦¬ (02)</option>
        <option value="03">ë¯¸ë¦¬ ë³´ê¸° (03)</option>
      </select>
    </div>
    <div class="form-group">
      <label>í…œí”Œë¦¿ ID:</label>
      <input id="templateId" placeholder="í…œí”Œë¦¿ ID ì…ë ¥" />
    </div>
    <div class="form-group" id="docIdGroup">
      <label>ë¬¸ì„œ ID (Mode 02,03 í•„ìˆ˜):</label>
      <input id="documentId" placeholder="ë¬¸ì„œ ID ì…ë ¥" />
    </div>

    <!-- ì¶”ê°€ ì˜µì…˜ -->
    <button id="toggleOptionsBtn" class="btn">ì¶”ê°€ ì˜µì…˜ ì„¤ì •</button>
    <div id="additionalOptions">
      <!-- ë ˆì´ì•„ì›ƒ ì˜µì…˜ -->
      <div class="option-section">
        <h3>ë ˆì´ì•„ì›ƒ ì˜µì…˜</h3>
        <div class="form-group">
          <label>ì–¸ì–´ (layout.lang_code):</label>
          <select id="layoutLang">
            <option value="ko" selected>ko</option>
            <option value="en">en</option>
            <option value="ja">ja</option>
          </select>
        </div>
        <div class="form-group">
          <label>í—¤ë” í‘œì‹œ</label>
          <label class="switch">
            <input type="checkbox" id="layoutHeader" checked />
            <span class="slider"></span>
          </label>
        </div>
        <div class="form-group">
          <label>í‘¸í„° í‘œì‹œ</label>
          <label class="switch">
            <input type="checkbox" id="layoutFooter" checked />
            <span class="slider"></span>
          </label>
        </div>
        <div class="form-group">
          <label>ì»¨í…ìŠ¤íŠ¸ ë©”ë‰´ í‘œì‹œ</label>
          <label class="switch">
            <input type="checkbox" id="layoutContextMenu" checked />
            <span class="slider"></span>
          </label>
        </div>
        <div class="form-group">
          <label>ì¤Œ ë ˆë²¨ (layout.zoom):</label>
          <input id="layoutZoom" value="1.0" placeholder="ì˜ˆ: 0.5" />
        </div>
        <div class="form-group">
          <label>ì €ì¥ ë²„íŠ¼ í‘œì‹œ</label>
          <label class="switch">
            <input type="checkbox" id="layoutSave" checked />
            <span class="slider"></span>
          </label>
        </div>
        <div class="form-group">
          <label>ì¸ì‡„ ë²„íŠ¼ í‘œì‹œ</label>
          <label class="switch">
            <input type="checkbox" id="layoutPrint" checked />
            <span class="slider"></span>
          </label>
        </div>
      </div>

      <!-- Prefill ì˜µì…˜ -->
      <div class="option-section">
        <h3>Prefill ì˜µì…˜</h3>
        <div class="form-group">
          <label>ë¬¸ì„œ ì œëª© (prefill.document_name):</label>
          <input id="prefillDocumentName" placeholder="ë¬¸ì„œ ì œëª© ì…ë ¥" />
        </div>
        <div class="form-group">
          <label>ì½”ë©˜íŠ¸ (prefill.comment):</label>
          <textarea id="prefillComment" rows="2" placeholder="ë©”ì‹œì§€ ì…ë ¥"></textarea>
        </div>
        <div class="form-group">
          <label>íšŒì‚¬ ë„ì¥ ì›Œí„°ë§ˆí¬ ìˆ¨ê¸°ê¸° (prefill.is_hidden_stamp):</label>
          <label class="switch">
            <input type="checkbox" id="prefillHiddenStamp" />
            <span class="slider"></span>
          </label>
        </div>
      </div>

      <!-- í•„ë“œ ì„¤ì • -->
      <div class="option-section">
        <h3>í•„ë“œ ì„¤ì • (prefill.fields)</h3>
        <button type="button" id="addFieldBtn" class="btn">í•„ë“œ ì¶”ê°€</button>
        <div id="fieldsList" class="entry-list"></div>
      </div>

      <!-- ìˆ˜ì‹ ì ì„¤ì • -->
      <div class="option-section">
        <h3>ìˆ˜ì‹ ì ì„¤ì • (prefill.recipients)</h3>
        <button type="button" id="addRecipientBtn" class="btn">ìˆ˜ì‹ ì ì¶”ê°€</button>
        <div id="recipientsList" class="entry-list"></div>
      </div>
    </div>

    <button id="startButton" class="btn">Start</button>
  </div>

  <div class="right-panel">
    <h2 class="iframe-title">ë¬¸ì„œ ì˜ì—­</h2>
    <div id="loadingIndicator">â³ ì„ë² ë”© ì¤‘â€¦</div>

    <div class="form-group" style="margin-bottom:10px;">
      <label class="switch">
        <input type="checkbox" id="toggleActionSwitch" />
        <span class="slider"></span>
      </label>
      <label id="toggleActionLabel" style="margin-left:8px;vertical-align:middle"></label>
    </div>

    <div id="buttonList">
      <button id="btn_01" onclick="actionTest('01')"></button>
      <button id="btn_02" onclick="actionTest('02')"></button>
      <button id="btn_03" onclick="actionTest('03')"></button>
      <button id="btn_04" onclick="actionTest('04')"></button>
      <button id="btn_05" onclick="actionTest('05')"></button>
      <button id="btn_06" onclick="actionTest('06')"></button>
      <button id="btn_07" onclick="actionTest('07')"></button>
      <button id="btn_08" onclick="actionTest('08')"></button>
      <button id="btn_09" onclick="actionTest('09')"></button>
      <button id="btn_10" onclick="actionTest('10')"></button>
      <button id="btn_11" onclick="actionTest('11')"></button>
      <button id="btn_12" onclick="actionTest('12')"></button>
      <button id="btn_13" onclick="actionTest('13')"></button>
      <button id="btn_14" onclick="actionTest('14')"></button>
      <button id="btn_15" onclick="actionTest('15')"></button>
      <button id="btn_16" onclick="actionTest('16')"></button>
      <button id="btn_17" onclick="actionTest('17')"></button>
      <button id="btn_18" onclick="actionTest('18')"></button>
      <button id="btn_19" onclick="actionTest('19')"></button>
      <button id="btn_20" onclick="actionTest('20')"></button>
      <button id="btn_21" onclick="actionTest('21')"></button>
      <button id="btn_22" style="width:150px" onclick="actionTest('22')"></button>
    </div>

    <div class="iframe-container">
      <iframe id="eformsign_iframe" name="eformsign_iframe"></iframe>
    </div>
  </div>
</body>
</html>
